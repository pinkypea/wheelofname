<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wheel of Names</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #6b48ff, #00ddeb);
        color: #fff;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        overflow-x: hidden;
      }

      header {
        text-align: center;
        padding: 20px;
        background: rgba(0, 0, 0, 0.2);
      }

      header img.logo {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        /* margin-bottom: 10px; */
      }

      header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
      }

      header p {
        font-size: 1.1rem;
        font-weight: 300;
        max-width: 600px;
        margin: 0 auto;
      }

      #logo {
        display: flex;
        align-items: center;
      }
      
      #main-container {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        gap: 70px;
        flex-wrap: wrap;
      }

      #wheel-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
      }

      #main-content {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      canvas {
        border-radius: 50%;
        cursor: pointer;
        transition: transform 0.3s;
        font-family: "Montserrat", sans-serif;
      }

      canvas:hover {
        transform: scale(1.02);
      }

      #arrow {
        position: absolute;
        top: 50%;
        left: calc(50% + 250px);
        transform: translateY(-50%) rotate(180deg);
        width: 0;
        height: 0;
        border-top: 30px solid transparent;
        border-bottom: 30px solid transparent;
        border-left: 50px solid #ff4d4d;
        z-index: 10;
        transition: border-left-color 0.2s;
      }

      #centerText {
        position: absolute;
        text-align: center;
        font-weight: 600;
        font-size: 24px;
        color: #fff;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        pointer-events: none;
      }

      #panel {
        width: 400px;
        height: 400px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
      }

      #panel h3 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 15px;
        color: #fff;
      }

      #names {
        flex: 1;
        resize: none;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.15);
        color: #fff;
        outline: none;
        font-family: "Montserrat", sans-serif;
      }

      #names::placeholder {
        color: #ccc;
      }

      #spinBtn {
        margin-top: 15px;
        padding: 12px;
        font-size: 18px;
        font-weight: 600;
        border: none;
        border-radius: 25px;
        background: linear-gradient(90deg, #ff4d4d, #ff8c1a);
        color: #fff;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      #spinBtn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
      }

      #winnerPopup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #ffffff; /* Solid white background */
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
  z-index: 100;
  text-align: center;
  max-width: 400px;
  width: 90%;
}

      #winnerPopup h2 {
        font-size: 32px;
        font-weight: 700;
        background: linear-gradient(90deg, #8a2be2, #ff69b4);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        /* text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4), 0 0 10px rgba(138, 43, 226, 0.5); */
        margin-bottom: 20px;
      }

      #winnerPopup .buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
      }

      #winnerPopup button {
        padding: 10px 20px;
        font-size: 16px;
        font-weight: 600;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      #removeBtn {
        background: linear-gradient(90deg, #ff4d4d, #e91e63);
        color: #fff;
      }

      #closeBtn {
        background: linear-gradient(90deg, #00b7eb, #00ddeb);
        color: #fff;
      }

      #winnerPopup button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
      }

      footer {
        text-align: center;
        padding: 15px;
        background: rgba(0, 0, 0, 0.2);
        font-size: 0.9rem;
        font-weight: 300;
      }

      footer a {
        color: #00ddeb;
        text-decoration: none;
        margin: 0 10px;
      }

      footer a:hover {
        text-decoration: underline;
      }

      .blur-background {
  filter: blur(5px);
  transition: filter 0.3s ease;
}

#fireworksCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 99;
  pointer-events: none;
}

      @media (max-width: 768px) {
        #main-container {
          flex-direction: column;
          padding: 10px;
        }

        #panel {
          width: 100%;
          max-width: 400px;
        }

        canvas {
          width: 300px;
          height: 300px;
          
        }

        #arrow {
          left: calc(50% + 150px);
          border-top: 20px solid transparent;
          border-bottom: 20px solid transparent;
          border-left: 30px solid #ff4d4d;
        }

        #centerText {
          font-size: 18px;
        }

        #winner {
  font-size: 20px;
}
      }
    </style>
  </head>
  <body>
    <header>
      <div id="logo">
        <img src="./logo-dark-background-38.png" alt="Wheel of Names Logo" class="logo">
      <h1>Wheel of Names</h1>
      </div>
      <p>Free and easy to use spinner. Enter names, spin wheel to pick a random winner.</p>
    </header>
    <div id="main-container">
      <div id="wheel-container">
        <div id="main-content">
          <div id="arrow"></div>
          <canvas id="wheel" width="500" height="500"></canvas>
          <div id="centerText">Click to spin</div>
        </div>
      </div>
      <div id="panel">
        <h3>Enter Names</h3>
        <textarea id="names" placeholder="Enter one name per line">
Dung
Dương
Đức
</textarea>
        <button id="spinBtn">Spin the Wheel</button>
      </div>
    </div>
    <canvas id="fireworksCanvas"></canvas>
    <div id="winnerPopup">
      <h2 id="winnerText"></h2>
      <div class="buttons">
        <button id="removeBtn">Remove</button>
        <button id="closeBtn">Close</button>
      </div>
    </div>
    <footer>
      <p>© 2025 Wheel of Names | <a href="#">Privacy</a> | <a href="#">How It Works</a> | <a href="#">Contact</a></p>
      <p>100% renewable energy servers</p>
    </footer>

    <script>
  const canvas = document.getElementById("wheel");
  const ctx = canvas.getContext("2d");
  const namesInput = document.getElementById("names");
  const spinBtn = document.getElementById("spinBtn");
  const centerText = document.getElementById("centerText");
  const arrow = document.getElementById("arrow");
  const winnerPopup = document.getElementById("winnerPopup");
  const winnerText = document.getElementById("winnerText");
  const removeBtn = document.getElementById("removeBtn");
  const closeBtn = document.getElementById("closeBtn");
  const fireworksCanvas = document.getElementById("fireworksCanvas");
  const fwCtx = fireworksCanvas.getContext("2d");
  const header = document.querySelector("header");
  const mainContainer = document.getElementById("main-container");
  const footer = document.querySelector("footer");

  let names = [];
  let startAngle = 4;
  let arc = 0;
  let spinAngle = 0;
  let spinTime = 0;
  let spinTimeTotal = 0;
  let spinning = false;
  let targetAngle = 0;
  let lastTime = null;
  let particles = [];

  // Resize fireworks canvas to full window
  function resizeFireworksCanvas() {
    fireworksCanvas.width = window.innerWidth;
    fireworksCanvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resizeFireworksCanvas);
  resizeFireworksCanvas();

  // Fireworks particle class
// Fireworks particle class
class Particle {
  constructor(x, y, hue) {
    this.x = x;
    this.y = y;
    this.hue = hue; // Store hue separately
    this.radius = Math.random() * 3 + 1; // Larger range: 1 to 4
    this.vx = Math.random() * 6 - 3; // Wider velocity range: -3 to 3
    this.vy = Math.random() * 6 - 3;
    this.life = 200; // Increased from 100 to 200
    this.maxLife = 200; // Store max life for opacity
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.02; // Gravity
    this.life -= 1;
    this.radius *= 0.995; // Slower fade-out for trails
  }

  draw() {
    // Glow effect: larger, semi-transparent circle
    fwCtx.beginPath();
    fwCtx.arc(this.x, this.y, this.radius * 2, 0, Math.PI * 2);
    fwCtx.fillStyle = `hsla(${this.hue}, 90%, 70%, 0.2)`; // 20% opacity for glow
    fwCtx.fill();

    // Main particle
    fwCtx.beginPath();
    fwCtx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
    fwCtx.fillStyle = `hsla(${this.hue}, 90%, 70%, ${this.life / this.maxLife})`; // Fade opacity
    fwCtx.fill();
  }
}

// Fireworks animation
function createFireworks() {
  const count = 100; // Increased from 30 to 100
  const centerX = fireworksCanvas.width / 2;
  const centerY = fireworksCanvas.height / 2;
  for (let i = 0; i < count; i++) {
    const hue = Math.random() * 360;
    particles.push(new Particle(centerX, centerY, hue)); // Pass hue instead of full color
  }
}

function animateFireworks() {
  fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
  particles = particles.filter(p => p.life > 0);
  particles.forEach(p => {
    p.update();
    p.draw();
  });
  // Add new burst every 50 frames while popup is visible
  if (particles.length > 0 || winnerPopup.style.display === "block") {
    if (particles.length === 0) {
      createFireworks(); // Create new burst
    }
    requestAnimationFrame(animateFireworks);
  }
}

  function toggleBlurBackground(enable) {
    if (enable) {
      header.classList.add("blur-background");
      mainContainer.classList.add("blur-background");
      footer.classList.add("blur-background");
    } else {
      header.classList.remove("blur-background");
      mainContainer.classList.remove("blur-background");
      footer.classList.remove("blur-background");
    }
  }

  function updateNames() {
    names = namesInput.value
      .split("\n")
      .map(n => n.trim())
      .filter(n => n);
    if (names.length === 0) names = ["No Name"];
    arc = (Math.PI * 2) / names.length;
    startAngle = -arc / 4; // Offset to point inside first segment
    drawWheel();
    colorArrow();
  }

  function randomColor(i) {
    const hue = (i * 360) / names.length;
    return `hsl(${hue}, 80%, 50%)`;
  }

  function drawWheel() {
    ctx.clearRect(0, 0, 500, 500);
    ctx.strokeStyle = "#fff";
    ctx.lineWidth = 3;
    for (let i = 0; i < names.length; i++) {
      const angle = startAngle + i * arc;
      ctx.fillStyle = randomColor(i);
      ctx.beginPath();
      ctx.moveTo(250, 250);
      ctx.arc(250, 250, 250, angle, angle + arc, false);
      ctx.lineTo(250, 250);
      ctx.fill();
      ctx.stroke();

      ctx.save();
      ctx.translate(250, 250);
      ctx.rotate(angle + arc / 2);
      ctx.fillStyle = "#fff";
      ctx.font = "bold 20px Poppins";
      ctx.textAlign = "right";
      ctx.fillText(names[i], 230, 10);
      ctx.restore();
    }
    ctx.beginPath();
    ctx.arc(250, 250, 40, 0, 2 * Math.PI);
    ctx.fillStyle = "#fff";
    ctx.fill();
  }

  function colorArrow() {
    const degrees = ((startAngle * 180) / Math.PI) % 360;
    const arcd = (arc * 180) / Math.PI;
    let index = Math.floor(((360 - degrees) % 360) / arcd);
    if (index < 0) index += names.length;
    arrow.style.borderLeftColor = randomColor(index);
  }

  function rotateWheel(timestamp) {
    if (!lastTime) lastTime = timestamp;
    const delta = timestamp - lastTime;
    lastTime = timestamp;
    spinTime += delta;

    if (spinTime >= spinTimeTotal) {
      startAngle = targetAngle % (2 * Math.PI);
      drawWheel();
      colorArrow();
      stopRotateWheel();
      lastTime = null;
      return;
    }

    const t = spinTime / spinTimeTotal;
    const easeOut = 1 - Math.pow(1 - t, 3);
    startAngle = spinAngle + easeOut * (targetAngle - spinAngle);

    drawWheel();
    colorArrow();
    requestAnimationFrame(rotateWheel);
  }

  function stopRotateWheel() {
  spinning = false;
  startAngle = targetAngle % (2 * Math.PI);
  const winnerName = names[0];
  winnerText.textContent = `🎉 Winner: ${winnerName}`;
  winnerPopup.style.display = "block";
  toggleBlurBackground(true);
  createFireworks(); // Initial burst
  animateFireworks();
  centerText.textContent = "Click to spin";
  drawWheel();
  colorArrow();
}

  function spin() {
  if (spinning) return;
  spinning = true;
  winnerPopup.style.display = "none";
  toggleBlurBackground(false);
  particles = [];
  fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
  centerText.textContent = "";
  spinTime = 0;
  lastTime = null;
  spinTimeTotal = 8000; // Increased from 6000ms to 8000ms
  spinAngle = startAngle;

  const index = 0;
  const arcCenter = arc / 3;
  const arrowAngle = 0;
  const stopAt = arrowAngle - arcCenter;
  const fullRotations = Math.PI * 2 * 10;
  targetAngle = startAngle + fullRotations + stopAt;

  requestAnimationFrame(rotateWheel);
}

  // Remove button: Remove winner and reset
  removeBtn.addEventListener("click", () => {
    names.shift();
    namesInput.value = names.join("\n");
    winnerPopup.style.display = "none";
    toggleBlurBackground(false);
    particles = [];
    fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
    updateNames();
  });

  // Close button: Close popup and reset
  closeBtn.addEventListener("click", () => {
    winnerPopup.style.display = "none";
    toggleBlurBackground(false);
    particles = [];
    fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
    // updateNames();
  });

  namesInput.addEventListener("input", updateNames);
  canvas.addEventListener("click", spin);
  spinBtn.addEventListener("click", spin);

  updateNames();
</script>
  </body>
</html>